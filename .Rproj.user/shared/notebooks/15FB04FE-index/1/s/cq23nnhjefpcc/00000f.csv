"0","# Data"
"0","data_1 = readRDS(""data/1_gw_weekly_scores.RDS"")"
"0","# # Value for Slider"
"0","# slider_1_max_val = max(data_1$event)"
"0","current_gw = max(data_1$event)"
"0","# "
"0","# shinyApp("
"0","#   "
"0","#   ui = fluidPage("
"0","#     sliderInput(inputId = ""p1_slider"","
"0","#                 label = h4(""Gameweek:""),"
"0","#                 min = 1,max = slider_1_max_val,value = slider_1_max_val,"
"0","#                 step = 1,round = T),"
"0","#     plotOutput(""p1_plot_avg"")"
"0","#   ),"
"0","#   "
"0","#   server = function(input, output) {"
"0","#     "
"0","#     output$p1_plot_avg = renderPlot({"
"0","#       "
"0","#       data_1_avg = unique(data_1$average_entry_score)"
"0","#       data_1_avg = data_1 %>% filter(event == input$p1_slider) %>% distinct(average_entry_score) %>% pull()"
"0","#       "
"0","#       ggplot(subset(data_1,event == input$p1_slider),aes(x=reorder(name,-points),y=points,fill = above_avg))+"
"0","#         geom_bar(color = 'black',stat = 'identity')+"
"0","#         geom_text(aes(label = points),position = position_stack(vjust = .5)) +"
"0","#         geom_hline(yintercept = data_1_avg)+"
"0","#         # geom_text(aes(nrow(data_1)-2,data_1_avg+2,label = ""Average"",vjust = -1))+"
"0","#         scale_fill_manual(values = c("
"0","#           ""Above Average"" = ""green"","
"0","#           ""Below Average"" = ""red"""
"0","#         ),name = ""Average"")+"
"0","#         theme_minimal()+"
"0","#         theme(plot.title = element_text(face='bold'),"
"0","#               axis.title = element_text(face='bold'),"
"0","#               axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+"
"0","#         labs(title = paste0(""Gameweek "",input$p1_slider,"" Performance""),"
"0","#              y = ""Points"",x = ""Participants"")"
"0","#     })"
"0","#   },"
"0","#   "
"0","#   options = list(height = 500)"
"0","# )"
"0",""
"0","data_1_avg = data_1 %>% filter(event == current_gw) %>% distinct(average_entry_score) %>% pull()"
"0",""
"0","ggplot(subset(data_1,event == current_gw),aes(x=reorder(name,-points),y=points,fill = above_avg))+"
"0","  geom_bar(color = 'black',stat = 'identity')+"
"0","  geom_text(aes(label = points),position = position_stack(vjust = .5)) +"
"0","  geom_hline(yintercept = data_1_avg)+"
"0","  # geom_text(aes(nrow(data_1)-2,data_1_avg+2,label = ""Average"",vjust = -1))+"
"0","  scale_fill_manual(values = c("
"0","    ""Above Average"" = ""#06d6a0"","
"0","    ""Below Average"" = ""#ef476f"""
"0","  ),name = ""Average"")+"
"0","  theme_minimal()+"
"0","  theme(plot.title = element_text(face='bold'),"
"0","        axis.title = element_text(face='bold'),"
"0","        axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+"
"0","  labs(title = paste0(""Gameweek "",current_gw,"" Performance""),"
"0","       y = ""Points"",x = ""Participants"")"
"0",""
